<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Manual de Usuario - Extensi√≥n Google Drive para Business Central</title>
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            line-height: 1.6;
            color: #333;
            max-width: 1000px;
            margin: 0 auto;
            padding: 20px;
            background-color: #fff;
        }
        
        h1 {
            color: #2c3e50;
            border-bottom: 3px solid #3498db;
            padding-bottom: 10px;
            font-size: 2.5em;
            margin-top: 0;
        }
        
        h2 {
            color: #34495e;
            border-bottom: 2px solid #ecf0f1;
            padding-bottom: 8px;
            margin-top: 40px;
            font-size: 1.8em;
        }
        
        h3 {
            color: #2c3e50;
            margin-top: 30px;
            font-size: 1.4em;
        }
        
        h4 {
            color: #34495e;
            margin-top: 25px;
            font-size: 1.2em;
        }
        
        .toc {
            background-color: #f8f9fa;
            border: 1px solid #dee2e6;
            border-radius: 5px;
            padding: 20px;
            margin: 30px 0;
        }
        
        .toc h2 {
            margin-top: 0;
            color: #495057;
            border-bottom: 1px solid #dee2e6;
        }
        
        .toc ul {
            list-style-type: none;
            padding-left: 0;
        }
        
        .toc li {
            margin: 8px 0;
        }
        
        .toc a {
            text-decoration: none;
            color: #007bff;
            font-weight: 500;
        }
        
        .toc a:hover {
            text-decoration: underline;
        }
        
        .highlight {
            background-color: #fff3cd;
            border: 1px solid #ffeaa7;
            border-radius: 4px;
            padding: 15px;
            margin: 20px 0;
        }
        
        .success {
            background-color: #d4edda;
            border: 1px solid #c3e6cb;
            color: #155724;
        }
        
        .warning {
            background-color: #fff3cd;
            border: 1px solid #ffeaa7;
            color: #856404;
        }
        
        .info {
            background-color: #d1ecf1;
            border: 1px solid #bee5eb;
            color: #0c5460;
        }
        
        code {
            background-color: #f8f9fa;
            border: 1px solid #e9ecef;
            border-radius: 3px;
            padding: 2px 6px;
            font-family: 'Courier New', monospace;
            font-size: 0.9em;
        }
        
        pre {
            background-color: #f8f9fa;
            border: 1px solid #e9ecef;
            border-radius: 5px;
            padding: 15px;
            overflow-x: auto;
            font-family: 'Courier New', monospace;
            font-size: 0.9em;
        }
        
        table {
            width: 100%;
            border-collapse: collapse;
            margin: 20px 0;
            background-color: #fff;
        }
        
        th, td {
            border: 1px solid #dee2e6;
            padding: 12px;
            text-align: left;
        }
        
        th {
            background-color: #f8f9fa;
            font-weight: 600;
            color: #495057;
        }
        
        tr:nth-child(even) {
            background-color: #f8f9fa;
        }
        
        .feature-list {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin: 20px 0;
        }
        
        .feature-item {
            background-color: #f8f9fa;
            border-left: 4px solid #007bff;
            padding: 15px;
            border-radius: 0 5px 5px 0;
        }
        
        .step-list {
            counter-reset: step-counter;
            list-style: none;
            padding-left: 0;
        }
        
        .step-list li {
            counter-increment: step-counter;
            margin: 15px 0;
            padding: 15px;
            background-color: #f8f9fa;
            border-left: 4px solid #28a745;
            border-radius: 0 5px 5px 0;
            position: relative;
        }
        
        .step-list li::before {
            content: counter(step-counter);
            position: absolute;
            left: -20px;
            top: 15px;
            background-color: #28a745;
            color: white;
            width: 30px;
            height: 30px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
        }
        
        .requirements {
            background-color: #e7f3ff;
            border: 1px solid #b3d9ff;
            border-radius: 5px;
            padding: 20px;
            margin: 20px 0;
        }
        
        .troubleshooting {
            background-color: #fff5f5;
            border: 1px solid #fed7d7;
            border-radius: 5px;
            padding: 20px;
            margin: 20px 0;
        }
        
        @media print {
            body {
                font-size: 12pt;
                line-height: 1.4;
            }
            
            h1 {
                page-break-before: always;
                font-size: 18pt;
            }
            
            h2 {
                page-break-before: always;
                font-size: 16pt;
            }
            
            h3 {
                font-size: 14pt;
            }
            
            .toc {
                page-break-after: always;
            }
            
            pre, table {
                page-break-inside: avoid;
            }
        }
    </style>
</head>
<body>
    <h1>Manual de Usuario - Extensi√≥n Google Drive para Business Central</h1>

    <div class="toc">
        <h2>Tabla de Contenidos</h2>
        <ul>
            <li><a href="#introduccion">1. Introducci√≥n</a></li>
            <li><a href="#requisitos">2. Requisitos Previos</a></li>
            <li><a href="#configuracion">3. Configuraci√≥n Inicial</a></li>
            <li><a href="#funcionalidades">4. Funcionalidades Principales</a></li>
            <li><a href="#gestion-archivos">5. Gesti√≥n de Archivos</a></li>
            <li><a href="#configuracion-carpetas">6. Configuraci√≥n de Carpetas</a></li>
            <li><a href="#integracion-documentos">7. Integraci√≥n con Documentos Adjuntos</a></li>
            <li><a href="#casos-uso">8. Casos de Uso Comunes</a></li>
            <li><a href="#solucion-problemas">9. Soluci√≥n de Problemas</a></li>
            <li><a href="#preguntas-frecuentes">10. Preguntas Frecuentes</a></li>
            <li><a href="#mejores-practicas">11. Mejores Pr√°cticas</a></li>
            <li><a href="#soporte">12. Soporte y Contacto</a></li>
        </ul>
    </div>

    <section id="introduccion">
        <h2>1. Introducci√≥n</h2>
        <p>La <strong>Extensi√≥n Google Drive para Business Central</strong> permite integrar completamente Google Drive con Microsoft Dynamics 365 Business Central, proporcionando capacidades avanzadas de gesti√≥n de documentos y archivos directamente desde el ERP.</p>

        <h3>Caracter√≠sticas Principales</h3>
        <div class="feature-list">
            <div class="feature-item">
                <strong>‚úÖ Navegaci√≥n completa</strong><br>
                Por carpetas y archivos de Google Drive
            </div>
            <div class="feature-item">
                <strong>‚úÖ Subida y descarga</strong><br>
                De archivos con interfaz intuitiva
            </div>
            <div class="feature-item">
                <strong>‚úÖ Creaci√≥n y eliminaci√≥n</strong><br>
                De carpetas directamente desde BC
            </div>
            <div class="feature-item">
                <strong>‚úÖ Movimiento de archivos</strong><br>
                Entre carpetas con drag & drop
            </div>
            <div class="feature-item">
                <strong>‚úÖ Integraci√≥n nativa</strong><br>
                Con el sistema de documentos adjuntos
            </div>
            <div class="feature-item">
                <strong>‚úÖ Configuraci√≥n autom√°tica</strong><br>
                De carpetas por tipo de documento
            </div>
            <div class="feature-item">
                <strong>‚úÖ Autenticaci√≥n OAuth2</strong><br>
                Segura y est√°ndar de Google
            </div>
            <div class="feature-item">
                <strong>‚úÖ Selecci√≥n m√∫ltiple</strong><br>
                De archivos para operaciones en lote
            </div>
        </div>
    </section>

    <section id="requisitos">
        <h2>2. Requisitos Previos</h2>
        
        <div class="requirements">
            <h3>Requisitos del Sistema</h3>
            <ul>
                <li>Microsoft Dynamics 365 Business Central (versi√≥n 18.0 o superior)</li>
                <li>Cuenta de Google Drive activa</li>
                <li>Permisos de administrador en Business Central</li>
                <li>Conexi√≥n a Internet estable</li>
            </ul>
        </div>

        <h3>Configuraci√≥n en Google Cloud Console</h3>
        <p>Antes de usar la extensi√≥n, debe configurar un proyecto en Google Cloud Console:</p>

        <ol class="step-list">
            <li>
                <strong>Crear un Proyecto en Google Cloud Console</strong><br>
                Vaya a <a href="https://console.cloud.google.com/">Google Cloud Console</a> y cree un nuevo proyecto o seleccione uno existente
            </li>
            <li>
                <strong>Habilitar la API de Google Drive</strong><br>
                En el panel de APIs y servicios, busque "Google Drive API" y haga clic en "Habilitar"
            </li>
            <li>
                <strong>Crear Credenciales OAuth2</strong><br>
                Vaya a "Credenciales" ‚Üí "Crear credenciales" ‚Üí "ID de cliente OAuth"<br>
                Tipo de aplicaci√≥n: "Aplicaci√≥n web"<br>
                Configure las URIs de redirecci√≥n autorizadas
            </li>
            <li>
                <strong>Obtener Client ID y Client Secret</strong><br>
                Descargue el archivo JSON con las credenciales<br>
                Guarde el Client ID y Client Secret para la configuraci√≥n
            </li>
        </ol>
    </section>

    <section id="configuracion">
        <h2>3. Configuraci√≥n Inicial</h2>

        <h3>Paso 1: Configurar Credenciales de Google</h3>
        <ol class="step-list">
            <li>
                <strong>Acceder a Informaci√≥n de la Empresa</strong><br>
                Navegue a <code>Configuraci√≥n</code> ‚Üí <code>Informaci√≥n de la empresa</code><br>
                Busque la secci√≥n "Google Drive Configuration"
            </li>
            <li>
                <strong>Completar los Campos de Configuraci√≥n</strong><br>
                <pre>Google Client ID: [Su Client ID de Google]
Google Client Secret: [Su Client Secret de Google]
Google Auth URI: https://accounts.google.com/o/oauth2/auth
Google Token URI: https://oauth2.googleapis.com/token
Google Drive API URL: https://www.googleapis.com/drive/v3/</pre>
            </li>
        </ol>

        <h3>Paso 2: Autenticaci√≥n OAuth2</h3>
        <ol class="step-list">
            <li>
                <strong>Iniciar el Proceso de Autenticaci√≥n</strong><br>
                La primera vez que use cualquier funcionalidad de Google Drive, el sistema le solicitar√° autenticarse
            </li>
            <li>
                <strong>Completar la Autorizaci√≥n</strong><br>
                Se abrir√° una ventana del navegador<br>
                Inicie sesi√≥n con su cuenta de Google<br>
                Autorice el acceso a Google Drive<br>
                Copie el c√≥digo de autorizaci√≥n proporcionado
            </li>
            <li>
                <strong>Introducir el C√≥digo de Autorizaci√≥n</strong><br>
                Pegue el c√≥digo en el di√°logo de Business Central<br>
                El sistema obtendr√° autom√°ticamente los tokens de acceso
            </li>
        </ol>

        <h3>Paso 3: Verificar la Configuraci√≥n</h3>
        <div class="highlight success">
            <strong>Probar la Conexi√≥n:</strong> Use la acci√≥n "Test Folder Access" en cualquier configuraci√≥n para verificar que puede listar archivos y carpetas.
        </div>
    </section>

    <section id="funcionalidades">
        <h2>4. Funcionalidades Principales</h2>

        <h3>1. Explorador de Google Drive (Factbox)</h3>
        <p>El <strong>Google Drive Factbox</strong> proporciona una interfaz similar al explorador de archivos para navegar por Google Drive.</p>

        <h4>Caracter√≠sticas:</h4>
        <ul>
            <li><strong>Navegaci√≥n por carpetas:</strong> Haga doble clic en una carpeta para abrirla</li>
            <li><strong>Navegaci√≥n hacia atr√°s:</strong> Use el bot√≥n "Anterior" o haga clic en ".."</li>
            <li><strong>Visualizaci√≥n de tipos:</strong> Distingue entre carpetas y archivos</li>
            <li><strong>Acciones contextuales:</strong> Diferentes acciones seg√∫n el tipo de elemento</li>
        </ul>

        <h4>Acciones Disponibles:</h4>
        <table>
            <thead>
                <tr>
                    <th>Acci√≥n</th>
                    <th>Descripci√≥n</th>
                    <th>Disponible para</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td>Anterior</td>
                    <td>Navegar a la carpeta padre</td>
                    <td>Siempre</td>
                </tr>
                <tr>
                    <td>Descargar Archivo</td>
                    <td>Descargar archivos seleccionados</td>
                    <td>Solo archivos</td>
                </tr>
                <tr>
                    <td>Mover</td>
                    <td>Mover archivos/carpetas a otra ubicaci√≥n</td>
                    <td>Archivos y carpetas</td>
                </tr>
                <tr>
                    <td>Crear Carpeta</td>
                    <td>Crear nuevas carpetas</td>
                    <td>Siempre</td>
                </tr>
                <tr>
                    <td>Borrar</td>
                    <td>Eliminar archivos/carpetas</td>
                    <td>Archivos y carpetas</td>
                </tr>
                <tr>
                    <td>Subir Archivo</td>
                    <td>Cargar archivos desde el equipo local</td>
                    <td>Siempre</td>
                </tr>
            </tbody>
        </table>

        <h3>2. Lista de Google Drive (Selecci√≥n)</h3>
        <p>La <strong>Google Drive List</strong> permite seleccionar m√∫ltiples archivos para operaciones en lote.</p>

        <h4>Caracter√≠sticas:</h4>
        <ul>
            <li><strong>Selecci√≥n m√∫ltiple:</strong> Marque varios archivos usando checkboxes</li>
            <li><strong>Selecci√≥n individual:</strong> Haga clic en un archivo para seleccionarlo</li>
            <li><strong>Filtrado visual:</strong> Distingue carpetas de archivos</li>
            <li><strong>Navegaci√≥n completa:</strong> Misma funcionalidad que el Factbox</li>
        </ul>

        <h4>Acciones Especiales:</h4>
        <ul>
            <li><strong>Seleccionar:</strong> Seleccionar el archivo actual</li>
            <li><strong>Seleccionar Marcados:</strong> Seleccionar todos los archivos marcados</li>
            <li><strong>Todas las acciones del Factbox</strong></li>
        </ul>
    </section>

    <section id="gestion-archivos">
        <h2>5. Gesti√≥n de Archivos</h2>

        <h3>Subir Archivos</h3>
        
        <h4>1. Desde el Explorador</h4>
        <ol class="step-list">
            <li>Navegue a la carpeta deseada</li>
            <li>Haga clic en "Subir Archivo"</li>
            <li>Seleccione el archivo desde su equipo</li>
            <li>El archivo se cargar√° autom√°ticamente</li>
        </ol>

        <h4>2. Desde Documentos Adjuntos</h4>
        <ol class="step-list">
            <li>Use la acci√≥n "Cargar archivo desde Google Drive"</li>
            <li>Seleccione archivos existentes en Google Drive</li>
            <li>Se vincular√°n autom√°ticamente al registro</li>
        </ol>

        <h3>Descargar Archivos</h3>
        
        <h4>1. Descarga Individual</h4>
        <ol class="step-list">
            <li>Seleccione el archivo</li>
            <li>Haga clic en "Descargar Archivo"</li>
            <li>El archivo se descargar√° a su equipo</li>
        </ol>

        <h4>2. Descarga M√∫ltiple</h4>
        <ol class="step-list">
            <li>Marque varios archivos en la lista</li>
            <li>Use "Seleccionar Marcados"</li>
            <li>Procese la descarga en lote</li>
        </ol>

        <h3>Mover Archivos</h3>
        <ol class="step-list">
            <li>
                <strong>Seleccionar Origen</strong><br>
                Navegue al archivo/carpeta a mover y haga clic en "Mover"
            </li>
            <li>
                <strong>Seleccionar Destino</strong><br>
                El sistema mostrar√° las carpetas disponibles<br>
                Seleccione la carpeta de destino y confirme la operaci√≥n
            </li>
        </ol>

        <h3>Crear Carpetas</h3>
        <ol class="step-list">
            <li>
                <strong>Navegaci√≥n</strong><br>
                Vaya a la ubicaci√≥n donde crear la carpeta
            </li>
            <li>
                <strong>Creaci√≥n</strong><br>
                Haga clic en "Crear Carpeta"<br>
                Introduzca el nombre de la carpeta y confirme
            </li>
        </ol>

        <h3>Eliminar Elementos</h3>
        <div class="highlight warning">
            <strong>‚ö†Ô∏è Advertencia:</strong> Los elementos eliminados se mover√°n a la papelera de Google Drive y pueden ser recuperados desde all√≠.
        </div>
        <ol class="step-list">
            <li>Seleccione el archivo/carpeta a eliminar</li>
            <li>Haga clic en "Borrar"</li>
            <li>Confirme la eliminaci√≥n</li>
        </ol>
    </section>

    <section id="configuracion-carpetas">
        <h2>6. Configuraci√≥n de Carpetas</h2>

        <h3>Google Drive Folder Mapping</h3>
        <p>Esta funcionalidad permite configurar carpetas espec√≠ficas de Google Drive para diferentes tipos de documentos en Business Central.</p>

        <h4>Acceso a la Configuraci√≥n</h4>
        <p>Navegue a <code>Configuraci√≥n</code> ‚Üí <code>Google Drive Folder Mapping</code></p>

        <h4>Campos de Configuraci√≥n</h4>
        <table>
            <thead>
                <tr>
                    <th>Campo</th>
                    <th>Descripci√≥n</th>
                    <th>Ejemplo</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td><strong>Table ID</strong></td>
                    <td>ID de la tabla de BC</td>
                    <td>18 (Customer)</td>
                </tr>
                <tr>
                    <td><strong>Table Name</strong></td>
                    <td>Nombre de la tabla</td>
                    <td>Customer</td>
                </tr>
                <tr>
                    <td><strong>Default Folder Name</strong></td>
                    <td>Nombre de referencia</td>
                    <td>Clientes</td>
                </tr>
                <tr>
                    <td><strong>Default Folder ID</strong></td>
                    <td>ID de carpeta en Google Drive</td>
                    <td>1BxY...xyz</td>
                </tr>
                <tr>
                    <td><strong>Auto Create Subfolders</strong></td>
                    <td>Crear subcarpetas autom√°ticamente</td>
                    <td>‚úì</td>
                </tr>
                <tr>
                    <td><strong>Subfolder Pattern</strong></td>
                    <td>Patr√≥n para subcarpetas</td>
                    <td>{YEAR}/{DOCNO}</td>
                </tr>
                <tr>
                    <td><strong>Active</strong></td>
                    <td>Configuraci√≥n activa</td>
                    <td>‚úì</td>
                </tr>
                <tr>
                    <td><strong>Description</strong></td>
                    <td>Descripci√≥n opcional</td>
                    <td>Documentos de clientes</td>
                </tr>
            </tbody>
        </table>

        <h4>Patrones de Subcarpetas</h4>
        <p>Puede usar los siguientes tokens en el patr√≥n de subcarpetas:</p>
        <ul>
            <li><code>{DOCNO}</code>: N√∫mero de documento</li>
            <li><code>{YEAR}</code>: A√±o actual</li>
            <li><code>{MONTH}</code>: Mes actual (01-12)</li>
            <li><code>{DAY}</code>: D√≠a actual (01-31)</li>
            <li><code>{CUSTOMERNO}</code>: N√∫mero de cliente (si aplica)</li>
            <li><code>{VENDORNO}</code>: N√∫mero de proveedor (si aplica)</li>
        </ul>

        <h4>Ejemplos de Configuraci√≥n</h4>
        
        <div class="highlight info">
            <strong>Para Facturas de Venta:</strong><br>
            <pre>Table ID: 112
Default Folder Name: Facturas de Venta
Subfolder Pattern: {YEAR}/Facturas/{DOCNO}</pre>
        </div>

        <div class="highlight info">
            <strong>Para Documentos de Cliente:</strong><br>
            <pre>Table ID: 18
Default Folder Name: Clientes
Subfolder Pattern: {CUSTOMERNO}/{YEAR}</pre>
        </div>

        <h4>Acciones Disponibles</h4>
        <table>
            <thead>
                <tr>
                    <th>Acci√≥n</th>
                    <th>Descripci√≥n</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td>Configurar Mapeos por Defecto</td>
                    <td>Crea configuraciones predeterminadas para tablas comunes</td>
                </tr>
                <tr>
                    <td>Explorar Carpeta Google Drive</td>
                    <td>Abre el explorador para seleccionar carpetas</td>
                </tr>
                <tr>
                    <td>Recuperar ID de Carpeta</td>
                    <td>Busca autom√°ticamente el ID basado en el nombre</td>
                </tr>
                <tr>
                    <td>Probar Acceso a Carpeta</td>
                    <td>Verifica que la configuraci√≥n funciona correctamente</td>
                </tr>
                <tr>
                    <td>Crear Subcarpeta de Prueba</td>
                    <td>Crea una subcarpeta usando el patr√≥n configurado</td>
                </tr>
            </tbody>
        </table>
    </section>

    <section id="integracion-documentos">
        <h2>7. Integraci√≥n con Documentos Adjuntos</h2>

        <h3>Configuraci√≥n de Documentos Adjuntos</h3>
        <p>La extensi√≥n modifica el comportamiento est√°ndar de los documentos adjuntos para usar Google Drive como almacenamiento.</p>

        <h4>Campos Adicionales</h4>
        <p>En cualquier lista de documentos adjuntos, encontrar√°:</p>
        <ul>
            <li><strong>Store in Google Drive:</strong> Checkbox para habilitar almacenamiento en Google Drive</li>
            <li><strong>Google Drive ID:</strong> ID del archivo en Google Drive (solo lectura)</li>
        </ul>

        <h4>Funcionalidades Mejoradas</h4>
        <ol class="step-list">
            <li>
                <strong>Carga Autom√°tica</strong><br>
                Los archivos marcados como "Store in Google Drive" se suben autom√°ticamente<br>
                Se almacena el ID de Google Drive en lugar del contenido en BC
            </li>
            <li>
                <strong>Descarga Transparente</strong><br>
                Al abrir un archivo almacenado en Google Drive<br>
                Se descarga autom√°ticamente desde Google Drive
            </li>
            <li>
                <strong>Gesti√≥n de Tipos de Archivo</strong><br>
                Reconocimiento autom√°tico de tipos de archivo<br>
                Configuraci√≥n de iconos y comportamientos espec√≠ficos
            </li>
        </ol>

        <h3>Cargar Archivos desde Google Drive</h3>

        <h4>Proceso Paso a Paso</h4>
        <ol class="step-list">
            <li>
                <strong>Acceder a Documentos Adjuntos</strong><br>
                Abra cualquier registro que soporte documentos adjuntos<br>
                Vaya a la secci√≥n "Documentos Adjuntos"
            </li>
            <li>
                <strong>Usar la Acci√≥n Especial</strong><br>
                Haga clic en "Cargar archivo desde Google Drive"<br>
                Se abrir√° el explorador de Google Drive
            </li>
            <li>
                <strong>Navegar y Seleccionar</strong><br>
                Navegue por las carpetas de Google Drive<br>
                Seleccione uno o m√∫ltiples archivos<br>
                Use "Seleccionar Marcados" para selecci√≥n m√∫ltiple
            </li>
            <li>
                <strong>Confirmaci√≥n</strong><br>
                Los archivos se vincular√°n autom√°ticamente al registro<br>
                Se crear√°n entradas de documentos adjuntos<br>
                Los archivos permanecen en Google Drive
            </li>
        </ol>

        <h4>Ventajas de esta Integraci√≥n</h4>
        <div class="feature-list">
            <div class="feature-item">
                <strong>üíæ Ahorro de Espacio</strong><br>
                Los archivos no se duplican en BC
            </div>
            <div class="feature-item">
                <strong>üîÑ Sincronizaci√≥n</strong><br>
                Cambios en Google Drive se reflejan autom√°ticamente
            </div>
            <div class="feature-item">
                <strong>üë• Colaboraci√≥n</strong><br>
                M√∫ltiples usuarios pueden acceder a los mismos archivos
            </div>
            <div class="feature-item">
                <strong>üìù Versionado</strong><br>
                Google Drive mantiene el historial de versiones
            </div>
        </div>
    </section>

    <section id="casos-uso">
        <h2>8. Casos de Uso Comunes</h2>

        <h3>1. Gesti√≥n de Documentos de Cliente</h3>
        <div class="highlight info">
            <strong>Escenario:</strong> Almacenar contratos, facturas y correspondencia de clientes.
            <br><br>
            <strong>Configuraci√≥n:</strong>
            <pre>Table ID: 18 (Customer)
Default Folder Name: Clientes
Subfolder Pattern: {CUSTOMERNO}/{YEAR}
Auto Create Subfolders: ‚úì</pre>
            <strong>Flujo de Trabajo:</strong>
            <ol>
                <li>Al adjuntar un documento a un cliente</li>
                <li>Se crea autom√°ticamente la carpeta "Clientes/CUST001/2024"</li>
                <li>El documento se almacena en Google Drive</li>
                <li>Se mantiene la referencia en Business Central</li>
            </ol>
        </div>

        <h3>2. Archivo de Facturas</h3>
        <div class="highlight info">
            <strong>Escenario:</strong> Organizar facturas por a√±o y n√∫mero.
            <br><br>
            <strong>Configuraci√≥n:</strong>
            <pre>Table ID: 112 (Sales Invoice Header)
Default Folder Name: Facturas
Subfolder Pattern: {YEAR}/Facturas/{DOCNO}
Auto Create Subfolders: ‚úì</pre>
            <strong>Resultado:</strong> Estructura como "Facturas/2024/Facturas/FAC-001"
        </div>

        <h3>3. Documentos de Productos</h3>
        <div class="highlight info">
            <strong>Escenario:</strong> Manuales, especificaciones t√©cnicas, im√°genes.
            <br><br>
            <strong>Configuraci√≥n:</strong>
            <pre>Table ID: 27 (Item)
Default Folder Name: Productos
Subfolder Pattern: {ITEMNO}/Documentos
Auto Create Subfolders: ‚úì</pre>
        </div>

        <h3>4. Gesti√≥n de Proyectos</h3>
        <div class="highlight info">
            <strong>Escenario:</strong> Documentos relacionados con proyectos espec√≠ficos.
            <br><br>
            <strong>Configuraci√≥n:</strong>
            <pre>Table ID: 167 (Job)
Default Folder Name: Proyectos
Subfolder Pattern: {JOBNO}/{YEAR}
Auto Create Subfolders: ‚úì</pre>
        </div>
    </section>

    <section id="solucion-problemas">
        <h2>9. Soluci√≥n de Problemas</h2>

        <div class="troubleshooting">
            <h3>Problemas de Autenticaci√≥n</h3>
            
            <h4>Error: "Token Expired"</h4>
            <p><strong>Causa:</strong> El token de acceso ha expirado.</p>
            <p><strong>Soluci√≥n:</strong></p>
            <ol>
                <li>El sistema intentar√° renovar autom√°ticamente el token</li>
                <li>Si falla, vuelva a autenticarse desde la configuraci√≥n</li>
                <li>Verifique que el Refresh Token sea v√°lido</li>
            </ol>

            <h4>Error: "Invalid Client ID"</h4>
            <p><strong>Causa:</strong> Credenciales incorrectas o proyecto de Google Cloud mal configurado.</p>
            <p><strong>Soluci√≥n:</strong></p>
            <ol>
                <li>Verifique el Client ID y Client Secret</li>
                <li>Confirme que la API de Google Drive est√° habilitada</li>
                <li>Revise las URIs de redirecci√≥n en Google Cloud Console</li>
            </ol>
        </div>

        <div class="troubleshooting">
            <h3>Problemas de Conectividad</h3>
            
            <h4>Error: "Cannot Connect to Google Drive"</h4>
            <p><strong>Causa:</strong> Problemas de red o configuraci√≥n de proxy.</p>
            <p><strong>Soluci√≥n:</strong></p>
            <ol>
                <li>Verifique la conexi√≥n a Internet</li>
                <li>Confirme que no hay bloqueos de firewall</li>
                <li>Revise la configuraci√≥n de proxy si aplica</li>
            </ol>

            <h4>Error: "Folder Not Found"</h4>
            <p><strong>Causa:</strong> ID de carpeta incorrecto o carpeta eliminada.</p>
            <p><strong>Soluci√≥n:</strong></p>
            <ol>
                <li>Verifique que la carpeta existe en Google Drive</li>
                <li>Confirme que tiene permisos de acceso</li>
                <li>Use "Recuperar ID de Carpeta" para obtener el ID correcto</li>
            </ol>
        </div>

        <div class="troubleshooting">
            <h3>Problemas de Permisos</h3>
            
            <h4>Error: "Access Denied"</h4>
            <p><strong>Causa:</strong> Permisos insuficientes en Google Drive.</p>
            <p><strong>Soluci√≥n:</strong></p>
            <ol>
                <li>Verifique que tiene permisos de escritura en la carpeta</li>
                <li>Confirme que la carpeta no est√° restringida</li>
                <li>Revise los permisos de compartir en Google Drive</li>
            </ol>

            <h4>Error: "Quota Exceeded"</h4>
            <p><strong>Causa:</strong> L√≠mite de almacenamiento de Google Drive alcanzado.</p>
            <p><strong>Soluci√≥n:</strong></p>
            <ol>
                <li>Libere espacio en Google Drive</li>
                <li>Considere actualizar su plan de almacenamiento</li>
                <li>Archive archivos antiguos</li>
            </ol>
        </div>
    </section>

    <section id="preguntas-frecuentes">
        <h2>10. Preguntas Frecuentes</h2>

        <h3>General</h3>
        <div class="highlight">
            <p><strong>P: ¬øPuedo usar m√∫ltiples cuentas de Google Drive?</strong></p>
            <p>R: Actualmente, la extensi√≥n soporta una cuenta de Google Drive por empresa en Business Central.</p>
        </div>

        <div class="highlight">
            <p><strong>P: ¬øLos archivos se sincronizan autom√°ticamente?</strong></p>
            <p>R: Los archivos se almacenan directamente en Google Drive. Los cambios realizados en Google Drive se reflejan inmediatamente en Business Central.</p>
        </div>

        <div class="highlight">
            <p><strong>P: ¬øQu√© pasa si elimino un archivo en Google Drive?</strong></p>
            <p>R: El enlace en Business Central seguir√° existiendo, pero el archivo no estar√° disponible. Se mostrar√° un error al intentar acceder.</p>
        </div>

        <h3>Seguridad</h3>
        <div class="highlight">
            <p><strong>P: ¬øEs segura la integraci√≥n?</strong></p>
            <p>R: S√≠, utiliza OAuth2 est√°ndar de Google y no almacena credenciales sensibles en Business Central.</p>
        </div>

        <div class="highlight">
            <p><strong>P: ¬øPuedo controlar qui√©n accede a los archivos?</strong></p>
            <p>R: Los permisos se gestionan desde Google Drive. Puede configurar permisos espec√≠ficos para cada carpeta y archivo.</p>
        </div>

        <h3>T√©cnicas</h3>
        <div class="highlight">
            <p><strong>P: ¬øHay l√≠mites de tama√±o de archivo?</strong></p>
            <p>R: Los l√≠mites son los mismos que Google Drive (15 GB por archivo para cuentas gratuitas).</p>
        </div>

        <div class="highlight">
            <p><strong>P: ¬øFunciona con Business Central On-Premises?</strong></p>
            <p>R: S√≠, siempre que tenga conexi√≥n a Internet para acceder a Google Drive.</p>
        </div>
    </section>

    <section id="mejores-practicas">
        <h2>11. Mejores Pr√°cticas</h2>

        <h3>Organizaci√≥n de Carpetas</h3>
        <ol class="step-list">
            <li>
                <strong>Estructura Jer√°rquica Clara</strong><br>
                Use una estructura l√≥gica y consistente<br>
                Evite carpetas demasiado profundas (m√°ximo 5 niveles)<br>
                Use nombres descriptivos y est√°ndares
            </li>
            <li>
                <strong>Convenciones de Nomenclatura</strong><br>
                Establezca convenciones claras para nombres de archivos<br>
                Use fechas en formato YYYY-MM-DD<br>
                Incluya identificadores √∫nicos cuando sea necesario
            </li>
            <li>
                <strong>Gesti√≥n de Permisos</strong><br>
                Configure permisos a nivel de carpeta principal<br>
                Use grupos de Google para gestionar accesos<br>
                Revise permisos regularmente
            </li>
        </ol>

        <h3>Configuraci√≥n de Mapeos</h3>
        <ol class="step-list">
            <li>
                <strong>Planificaci√≥n Previa</strong><br>
                Dise√±e la estructura de carpetas antes de configurar<br>
                Considere el crecimiento futuro<br>
                Documente las decisiones tomadas
            </li>
            <li>
                <strong>Patrones Consistentes</strong><br>
                Use patrones similares para tablas relacionadas<br>
                Evite patrones demasiado complejos<br>
                Pruebe los patrones antes de implementar
            </li>
        </ol>

        <h3>Rendimiento</h3>
        <ol class="step-list">
            <li>
                <strong>Optimizaci√≥n de Consultas</strong><br>
                Limite el n√∫mero de archivos por carpeta<br>
                Use subcarpetas para organizar grandes vol√∫menes<br>
                Evite consultas innecesarias
            </li>
            <li>
                <strong>Gesti√≥n de Cache</strong><br>
                Permita que el sistema mantenga tokens en cache<br>
                No fuerce renovaciones innecesarias<br>
                Monitoree el uso de la API
            </li>
        </ol>
    </section>

    <section id="soporte">
        <h2>12. Soporte y Contacto</h2>

        <h3>Recursos Adicionales</h3>
        <ul>
            <li><strong>Documentaci√≥n de Google Drive API:</strong> <a href="https://developers.google.com/drive">developers.google.com/drive</a></li>
            <li><strong>Business Central Documentation:</strong> <a href="https://docs.microsoft.com/dynamics365/business-central">docs.microsoft.com/dynamics365/business-central</a></li>
            <li><strong>OAuth2 Documentation:</strong> <a href="https://oauth.net/2/">oauth.net/2/</a></li>
        </ul>

        <h3>Informaci√≥n de Versi√≥n</h3>
        <table>
            <tr>
                <td><strong>Versi√≥n de la Extensi√≥n:</strong></td>
                <td>1.0.0</td>
            </tr>
            <tr>
                <td><strong>Compatibilidad:</strong></td>
                <td>Business Central 18.0+</td>
            </tr>
            <tr>
                <td><strong>√öltima Actualizaci√≥n:</strong></td>
                <td>2024</td>
            </tr>
            <tr>
                <td><strong>Autor:</strong></td>
                <td>[Informaci√≥n del desarrollador]</td>
            </tr>
        </table>

        <div class="highlight info">
            <p><strong>üìù Nota:</strong> Este manual est√° sujeto a actualizaciones. Consulte la documentaci√≥n m√°s reciente para obtener informaci√≥n actualizada sobre nuevas funcionalidades y cambios.</p>
        </div>
    </section>

    <footer style="margin-top: 50px; padding-top: 20px; border-top: 1px solid #dee2e6; text-align: center; color: #6c757d;">
        <p>Manual de Usuario - Extensi√≥n Google Drive para Business Central</p>
        <p>Generado el: <script>document.write(new Date().toLocaleDateString('es-ES'));</script></p>
    </footer>
</body>
</html> 